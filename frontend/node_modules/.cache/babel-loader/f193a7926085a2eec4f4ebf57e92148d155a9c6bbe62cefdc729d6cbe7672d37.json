{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{portfolioApi}from\"../api/endpoints\";import toast from\"react-hot-toast\";import{riskManagement,marketStatus}from\"../utils/tradingEngine\";import{LineChart,Line,XAxis,YAxis,CartesianGrid,Tooltip,Legend,ResponsiveContainer,BarChart,Bar}from\"recharts\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Portfolio(){var _selectedPortfolio$to,_selectedPortfolio$in,_ref,_selectedPortfolio$to2;const[portfolios,setPortfolios]=useState([]);const[selectedPortfolio,setSelectedPortfolio]=useState(null);const[isLoading,setIsLoading]=useState(false);const[showCreateForm,setShowCreateForm]=useState(false);const[newPortfolioName,setNewPortfolioName]=useState(\"\");const[addCapitalAmount,setAddCapitalAmount]=useState(\"\");// Risk metrics\nconst[riskMetrics,setRiskMetrics]=useState(null);useEffect(()=>{fetchPortfolios();// Update market status\nconst updateMarketStatus=()=>{setMarketOpen(marketStatus.isMarketOpen());};updateMarketStatus();const timer=setInterval(updateMarketStatus,60000);return()=>clearInterval(timer);},[]);// Calculate risk metrics when portfolio changes\nuseEffect(()=>{if(selectedPortfolio){calculateRiskMetrics(selectedPortfolio);}},[selectedPortfolio]);const fetchPortfolios=async()=>{setIsLoading(true);try{const response=await portfolioApi.getPortfolios();setPortfolios(response.data);if(response.data.length>0){setSelectedPortfolio(response.data[0]);}}catch(error){toast.error(\"Failed to fetch portfolios\");console.error(error);}finally{setIsLoading(false);}};const handleCreatePortfolio=async e=>{e.preventDefault();try{await portfolioApi.createPortfolio({name:newPortfolioName});toast.success(\"Portfolio created!\");setNewPortfolioName(\"\");setShowCreateForm(false);fetchPortfolios();}catch(error){toast.error(\"Failed to create portfolio\");console.error(error);}};const handleAddCapital=async e=>{e.preventDefault();if(!selectedPortfolio)return;try{await portfolioApi.addCapital(selectedPortfolio.id,parseFloat(addCapitalAmount));toast.success(\"Capital added!\");setAddCapitalAmount(\"\");fetchPortfolios();}catch(error){toast.error(\"Failed to add capital\");console.error(error);}};const calculateRiskMetrics=portfolio=>{if(!portfolio.positions||portfolio.positions.length===0){setRiskMetrics(null);return;}const positions=portfolio.positions;const totalCapital=portfolio.total_capital||100000;// Calculate metrics for each position\nconst positionRisks=positions.map(pos=>{const pnl=pos.current_price-pos.entry_price;const pnlPercent=pnl/pos.entry_price*100;const positionValue=pos.quantity*pos.current_price;const portfolioPercent=positionValue/totalCapital*100;// Estimate risk based on movement\nconst priceChange=Math.abs(pnl);const riskLevel=priceChange>pos.entry_price*0.05?\"HIGH\":priceChange>pos.entry_price*0.02?\"MEDIUM\":\"LOW\";return{symbol:pos.stock_symbol,quantity:pos.quantity,entry:pos.entry_price,current:pos.current_price,pnl,pnlPercent,positionValue,portfolioPercent:portfolioPercent.toFixed(2),riskLevel};});// Calculate totals\nconst totalInvested=positionRisks.reduce((sum,p)=>sum+p.positionValue,0);const totalUnrealized=positionRisks.reduce((sum,p)=>sum+p.pnl*p.quantity,0);const maxPositionPercent=Math.max(...positionRisks.map(p=>parseFloat(p.portfolioPercent)));const highRiskCount=positionRisks.filter(p=>p.riskLevel===\"HIGH\").length;// Risk warnings\nconst warnings=[];if(maxPositionPercent>20){warnings.push(\"‚ö†Ô∏è CONCENTRATION RISK: Largest position is > 20% of portfolio\");}if(highRiskCount>0){warnings.push(\"\\u26A0\\uFE0F HIGH VOLATILITY: \".concat(highRiskCount,\" position(s) with > 5% movement\"));}if(totalUnrealized/totalCapital<-0.05){warnings.push(\"‚ö†Ô∏è DRAWDOWN: Portfolio is down > 5%\");}// Recommendations\nconst recommendations=[];if(maxPositionPercent>15){recommendations.push(\"üí° Consider reducing largest position to < 15%\");}if(positionRisks.length<3){recommendations.push(\"üí° Add more stocks for diversification\");}if(highRiskCount>0){recommendations.push(\"üí° Review high-risk positions and consider tightening stops\");}setRiskMetrics({positions:positionRisks,totalCapital,totalInvested,totalUnrealized,maxPositionPercent,highRiskCount,warnings,recommendations,exposurePercent:(totalInvested/totalCapital*100).toFixed(2),diversificationScore:Math.min(100,positionRisks.length*20)});};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-md p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900\",children:\"Portfolio Management\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2\",children:\"Track your investments and positions\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCreateForm(!showCreateForm),className:\"bg-gradient-to-r from-primary to-secondary text-white font-semibold py-2 px-6 rounded-lg hover:shadow-lg transition\",children:\"\\u2795 New Portfolio\"})]})}),showCreateForm&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-md p-6\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCreatePortfolio,className:\"flex gap-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newPortfolioName,onChange:e=>setNewPortfolioName(e.target.value),placeholder:\"Portfolio name (e.g., My Trading Account)\",className:\"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-primary text-white font-semibold py-2 px-6 rounded-lg hover:shadow-lg transition\",children:\"Create\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowCreateForm(false),className:\"bg-gray-300 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:shadow-lg transition\",children:\"Cancel\"})]})}),portfolios.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2 overflow-x-auto pb-2\",children:portfolios.map(portfolio=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setSelectedPortfolio(portfolio),className:\"px-4 py-2 rounded-lg font-medium transition whitespace-nowrap \".concat((selectedPortfolio===null||selectedPortfolio===void 0?void 0:selectedPortfolio.id)===portfolio.id?\"bg-primary text-white\":\"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50\"),children:[\"\\uD83D\\uDCBC \",portfolio.name]},portfolio.id))}),selectedPortfolio&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[riskMetrics&&(riskMetrics.warnings.length>0||riskMetrics.recommendations.length>0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-yellow-50 border-l-4 border-yellow-400 rounded-lg p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-yellow-900 mb-3\",children:\"\\u26A0\\uFE0F Portfolio Risk Assessment\"}),riskMetrics.warnings.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-2 text-sm text-yellow-800\",children:riskMetrics.warnings.map((w,i)=>/*#__PURE__*/_jsx(\"li\",{children:w},i))})}),riskMetrics.recommendations.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"pt-4 border-t border-yellow-200\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-yellow-900 mb-2\",children:\"Recommendations:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-1 text-sm text-yellow-800\",children:riskMetrics.recommendations.map((r,i)=>/*#__PURE__*/_jsx(\"li\",{children:r},i))})]})]}),riskMetrics&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-1\",children:\"Portfolio Exposure\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-blue-600\",children:[riskMetrics.exposurePercent,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-2\",children:\"Invested vs Total Capital\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-1\",children:\"Max Position\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-orange-600\",children:[riskMetrics.maxPositionPercent.toFixed(1),\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-2\",children:\"Largest single position\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-1\",children:\"Diversification\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-green-600\",children:[riskMetrics.diversificationScore,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-2\",children:\"Number of stocks\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-1\",children:\"At-Risk Positions\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-red-600\",children:riskMetrics.highRiskCount}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-2\",children:\"With > 5% movement\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-1\",children:\"Total Capital\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-gray-900\",children:[\"\\u20B9\",(_selectedPortfolio$to=selectedPortfolio.total_capital)===null||_selectedPortfolio$to===void 0?void 0:_selectedPortfolio$to.toLocaleString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-1\",children:\"Invested Amount\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-blue-600\",children:[\"\\u20B9\",(_selectedPortfolio$in=selectedPortfolio.invested_amount)===null||_selectedPortfolio$in===void 0?void 0:_selectedPortfolio$in.toLocaleString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-1\",children:\"Cash Available\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-green-600\",children:[\"\\u20B9\",(_ref=selectedPortfolio.total_capital-selectedPortfolio.invested_amount)===null||_ref===void 0?void 0:_ref.toLocaleString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-1\",children:\"Total Returns\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold \".concat(selectedPortfolio.total_returns>=0?\"text-green-600\":\"text-red-600\"),children:[selectedPortfolio.total_returns>=0?\"+\":\"\",(_selectedPortfolio$to2=selectedPortfolio.total_returns)===null||_selectedPortfolio$to2===void 0?void 0:_selectedPortfolio$to2.toFixed(2),\"%\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-900 mb-4\",children:\"Add Capital\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAddCapital,className:\"flex gap-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:addCapitalAmount,onChange:e=>setAddCapitalAmount(e.target.value),placeholder:\"Amount to add (\\u20B9)\",className:\"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-green-600 text-white font-semibold py-2 px-6 rounded-lg hover:shadow-lg transition\",children:\"Add Funds\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-900 mb-4\",children:\"Open Positions\"}),selectedPortfolio.positions&&selectedPortfolio.positions.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-semibold text-gray-700\",children:\"Symbol\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-semibold text-gray-700\",children:\"Quantity\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-semibold text-gray-700\",children:\"Entry Price\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-semibold text-gray-700\",children:\"Current Price\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-semibold text-gray-700\",children:\"P&L\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-semibold text-gray-700\",children:\"P&L %\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y\",children:selectedPortfolio.positions.map(position=>{const pnl=position.current_price-position.entry_price;const pnlPercent=pnl/position.entry_price*100;return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 font-semibold text-gray-900\",children:position.stock_symbol}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-gray-700\",children:position.quantity}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-3 text-gray-700\",children:[\"\\u20B9\",position.entry_price]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-3 text-gray-700\",children:[\"\\u20B9\",position.current_price]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-3 font-semibold \".concat(pnl>=0?\"text-green-600\":\"text-red-600\"),children:[pnl>=0?\"+\":\"\",\"\\u20B9\",pnl.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-3 font-semibold \".concat(pnlPercent>=0?\"text-green-600\":\"text-red-600\"),children:[pnlPercent>=0?\"+\":\"\",pnlPercent.toFixed(2),\"%\"]})]},position.id);})})]})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"No open positions\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-900 mb-4\",children:\"Portfolio Performance\"}),selectedPortfolio.performance_history&&selectedPortfolio.performance_history.length>0?/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(LineChart,{data:selectedPortfolio.performance_history,children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"date\"}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{formatter:value=>\"\\u20B9\".concat(value.toLocaleString())}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Line,{type:\"monotone\",dataKey:\"value\",stroke:\"#0088FE\",dot:false,name:\"Portfolio Value\"})]})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"No performance data available yet\"})]})]}),portfolios.length===0&&!isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-12 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-lg\",children:\"No portfolios yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"Create your first portfolio to start tracking investments\"})]}),isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-block animate-spin text-4xl\",children:\"\\uD83D\\uDCBC\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-4\",children:\"Loading portfolios...\"})]})]});}","map":{"version":3,"names":["React","useState","useEffect","portfolioApi","toast","riskManagement","marketStatus","LineChart","Line","XAxis","YAxis","CartesianGrid","Tooltip","Legend","ResponsiveContainer","BarChart","Bar","jsx","_jsx","jsxs","_jsxs","Portfolio","_selectedPortfolio$to","_selectedPortfolio$in","_ref","_selectedPortfolio$to2","portfolios","setPortfolios","selectedPortfolio","setSelectedPortfolio","isLoading","setIsLoading","showCreateForm","setShowCreateForm","newPortfolioName","setNewPortfolioName","addCapitalAmount","setAddCapitalAmount","riskMetrics","setRiskMetrics","fetchPortfolios","updateMarketStatus","setMarketOpen","isMarketOpen","timer","setInterval","clearInterval","calculateRiskMetrics","response","getPortfolios","data","length","error","console","handleCreatePortfolio","e","preventDefault","createPortfolio","name","success","handleAddCapital","addCapital","id","parseFloat","portfolio","positions","totalCapital","total_capital","positionRisks","map","pos","pnl","current_price","entry_price","pnlPercent","positionValue","quantity","portfolioPercent","priceChange","Math","abs","riskLevel","symbol","stock_symbol","entry","current","toFixed","totalInvested","reduce","sum","p","totalUnrealized","maxPositionPercent","max","highRiskCount","filter","warnings","push","concat","recommendations","exposurePercent","diversificationScore","min","className","children","onClick","onSubmit","type","value","onChange","target","placeholder","required","w","i","r","toLocaleString","invested_amount","total_returns","position","performance_history","width","height","strokeDasharray","dataKey","formatter","stroke","dot"],"sources":["/home/vinod/Music/KVK_8833_PROFIT/frontend/src/pages/Portfolio.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { portfolioApi } from \"../api/endpoints\";\nimport toast from \"react-hot-toast\";\nimport { riskManagement, marketStatus } from \"../utils/tradingEngine\";\nimport {\n  LineChart,\n  Line,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  Legend,\n  ResponsiveContainer,\n  BarChart,\n  Bar,\n} from \"recharts\";\n\nexport default function Portfolio() {\n  const [portfolios, setPortfolios] = useState([]);\n  const [selectedPortfolio, setSelectedPortfolio] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [showCreateForm, setShowCreateForm] = useState(false);\n  const [newPortfolioName, setNewPortfolioName] = useState(\"\");\n  const [addCapitalAmount, setAddCapitalAmount] = useState(\"\");\n\n  // Risk metrics\n  const [riskMetrics, setRiskMetrics] = useState(null);\n\n  useEffect(() => {\n    fetchPortfolios();\n\n    // Update market status\n    const updateMarketStatus = () => {\n      setMarketOpen(marketStatus.isMarketOpen());\n    };\n\n    updateMarketStatus();\n    const timer = setInterval(updateMarketStatus, 60000);\n    return () => clearInterval(timer);\n  }, []);\n\n  // Calculate risk metrics when portfolio changes\n  useEffect(() => {\n    if (selectedPortfolio) {\n      calculateRiskMetrics(selectedPortfolio);\n    }\n  }, [selectedPortfolio]);\n\n  const fetchPortfolios = async () => {\n    setIsLoading(true);\n    try {\n      const response = await portfolioApi.getPortfolios();\n      setPortfolios(response.data);\n      if (response.data.length > 0) {\n        setSelectedPortfolio(response.data[0]);\n      }\n    } catch (error) {\n      toast.error(\"Failed to fetch portfolios\");\n      console.error(error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleCreatePortfolio = async (e) => {\n    e.preventDefault();\n    try {\n      await portfolioApi.createPortfolio({ name: newPortfolioName });\n      toast.success(\"Portfolio created!\");\n      setNewPortfolioName(\"\");\n      setShowCreateForm(false);\n      fetchPortfolios();\n    } catch (error) {\n      toast.error(\"Failed to create portfolio\");\n      console.error(error);\n    }\n  };\n\n  const handleAddCapital = async (e) => {\n    e.preventDefault();\n    if (!selectedPortfolio) return;\n\n    try {\n      await portfolioApi.addCapital(selectedPortfolio.id, parseFloat(addCapitalAmount));\n      toast.success(\"Capital added!\");\n      setAddCapitalAmount(\"\");\n      fetchPortfolios();\n    } catch (error) {\n      toast.error(\"Failed to add capital\");\n      console.error(error);\n    }\n  };\n\n  const calculateRiskMetrics = (portfolio) => {\n    if (!portfolio.positions || portfolio.positions.length === 0) {\n      setRiskMetrics(null);\n      return;\n    }\n\n    const positions = portfolio.positions;\n    const totalCapital = portfolio.total_capital || 100000;\n\n    // Calculate metrics for each position\n    const positionRisks = positions.map((pos) => {\n      const pnl = pos.current_price - pos.entry_price;\n      const pnlPercent = (pnl / pos.entry_price) * 100;\n      const positionValue = pos.quantity * pos.current_price;\n      const portfolioPercent = (positionValue / totalCapital) * 100;\n\n      // Estimate risk based on movement\n      const priceChange = Math.abs(pnl);\n      const riskLevel = priceChange > pos.entry_price * 0.05 ? \"HIGH\" : priceChange > pos.entry_price * 0.02 ? \"MEDIUM\" : \"LOW\";\n\n      return {\n        symbol: pos.stock_symbol,\n        quantity: pos.quantity,\n        entry: pos.entry_price,\n        current: pos.current_price,\n        pnl,\n        pnlPercent,\n        positionValue,\n        portfolioPercent: portfolioPercent.toFixed(2),\n        riskLevel\n      };\n    });\n\n    // Calculate totals\n    const totalInvested = positionRisks.reduce((sum, p) => sum + p.positionValue, 0);\n    const totalUnrealized = positionRisks.reduce((sum, p) => sum + p.pnl * p.quantity, 0);\n    const maxPositionPercent = Math.max(...positionRisks.map(p => parseFloat(p.portfolioPercent)));\n    const highRiskCount = positionRisks.filter(p => p.riskLevel === \"HIGH\").length;\n\n    // Risk warnings\n    const warnings = [];\n    if (maxPositionPercent > 20) {\n      warnings.push(\"‚ö†Ô∏è CONCENTRATION RISK: Largest position is > 20% of portfolio\");\n    }\n    if (highRiskCount > 0) {\n      warnings.push(`‚ö†Ô∏è HIGH VOLATILITY: ${highRiskCount} position(s) with > 5% movement`);\n    }\n    if (totalUnrealized / totalCapital < -0.05) {\n      warnings.push(\"‚ö†Ô∏è DRAWDOWN: Portfolio is down > 5%\");\n    }\n\n    // Recommendations\n    const recommendations = [];\n    if (maxPositionPercent > 15) {\n      recommendations.push(\"üí° Consider reducing largest position to < 15%\");\n    }\n    if (positionRisks.length < 3) {\n      recommendations.push(\"üí° Add more stocks for diversification\");\n    }\n    if (highRiskCount > 0) {\n      recommendations.push(\"üí° Review high-risk positions and consider tightening stops\");\n    }\n\n    setRiskMetrics({\n      positions: positionRisks,\n      totalCapital,\n      totalInvested,\n      totalUnrealized,\n      maxPositionPercent,\n      highRiskCount,\n      warnings,\n      recommendations,\n      exposurePercent: ((totalInvested / totalCapital) * 100).toFixed(2),\n      diversificationScore: Math.min(100, (positionRisks.length * 20))\n    });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"bg-white rounded-lg shadow-md p-6\">\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Portfolio Management</h1>\n            <p className=\"text-gray-600 mt-2\">Track your investments and positions</p>\n          </div>\n          <button\n            onClick={() => setShowCreateForm(!showCreateForm)}\n            className=\"bg-gradient-to-r from-primary to-secondary text-white font-semibold py-2 px-6 rounded-lg hover:shadow-lg transition\"\n          >\n            ‚ûï New Portfolio\n          </button>\n        </div>\n      </div>\n\n      {/* Create Portfolio Form */}\n      {showCreateForm && (\n        <div className=\"bg-white rounded-lg shadow-md p-6\">\n          <form onSubmit={handleCreatePortfolio} className=\"flex gap-4\">\n            <input\n              type=\"text\"\n              value={newPortfolioName}\n              onChange={(e) => setNewPortfolioName(e.target.value)}\n              placeholder=\"Portfolio name (e.g., My Trading Account)\"\n              className=\"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary\"\n              required\n            />\n            <button\n              type=\"submit\"\n              className=\"bg-primary text-white font-semibold py-2 px-6 rounded-lg hover:shadow-lg transition\"\n            >\n              Create\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setShowCreateForm(false)}\n              className=\"bg-gray-300 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:shadow-lg transition\"\n            >\n              Cancel\n            </button>\n          </form>\n        </div>\n      )}\n\n      {/* Portfolio Selection */}\n      {portfolios.length > 0 && (\n        <div className=\"flex gap-2 overflow-x-auto pb-2\">\n          {portfolios.map((portfolio) => (\n            <button\n              key={portfolio.id}\n              onClick={() => setSelectedPortfolio(portfolio)}\n              className={`px-4 py-2 rounded-lg font-medium transition whitespace-nowrap ${\n                selectedPortfolio?.id === portfolio.id\n                  ? \"bg-primary text-white\"\n                  : \"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50\"\n              }`}\n            >\n              üíº {portfolio.name}\n            </button>\n          ))}\n        </div>\n      )}\n\n      {/* Portfolio Overview */}\n      {selectedPortfolio && (\n        <div className=\"space-y-6\">\n          {/* Risk Alerts */}\n          {riskMetrics && (riskMetrics.warnings.length > 0 || riskMetrics.recommendations.length > 0) && (\n            <div className=\"bg-yellow-50 border-l-4 border-yellow-400 rounded-lg p-6\">\n              <h3 className=\"text-lg font-bold text-yellow-900 mb-3\">‚ö†Ô∏è Portfolio Risk Assessment</h3>\n              {riskMetrics.warnings.length > 0 && (\n                <div className=\"mb-4\">\n                  <ul className=\"space-y-2 text-sm text-yellow-800\">\n                    {riskMetrics.warnings.map((w, i) => (\n                      <li key={i}>{w}</li>\n                    ))}\n                  </ul>\n                </div>\n              )}\n              {riskMetrics.recommendations.length > 0 && (\n                <div className=\"pt-4 border-t border-yellow-200\">\n                  <p className=\"text-xs font-semibold text-yellow-900 mb-2\">Recommendations:</p>\n                  <ul className=\"space-y-1 text-sm text-yellow-800\">\n                    {riskMetrics.recommendations.map((r, i) => (\n                      <li key={i}>{r}</li>\n                    ))}\n                  </ul>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Risk Metrics Dashboard */}\n          {riskMetrics && (\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <div className=\"bg-white rounded-lg shadow-md p-4\">\n                <p className=\"text-sm text-gray-600 mb-1\">Portfolio Exposure</p>\n                <p className=\"text-3xl font-bold text-blue-600\">{riskMetrics.exposurePercent}%</p>\n                <p className=\"text-xs text-gray-500 mt-2\">Invested vs Total Capital</p>\n              </div>\n              <div className=\"bg-white rounded-lg shadow-md p-4\">\n                <p className=\"text-sm text-gray-600 mb-1\">Max Position</p>\n                <p className=\"text-3xl font-bold text-orange-600\">{riskMetrics.maxPositionPercent.toFixed(1)}%</p>\n                <p className=\"text-xs text-gray-500 mt-2\">Largest single position</p>\n              </div>\n              <div className=\"bg-white rounded-lg shadow-md p-4\">\n                <p className=\"text-sm text-gray-600 mb-1\">Diversification</p>\n                <p className=\"text-3xl font-bold text-green-600\">{riskMetrics.diversificationScore}%</p>\n                <p className=\"text-xs text-gray-500 mt-2\">Number of stocks</p>\n              </div>\n              <div className=\"bg-white rounded-lg shadow-md p-4\">\n                <p className=\"text-sm text-gray-600 mb-1\">At-Risk Positions</p>\n                <p className=\"text-3xl font-bold text-red-600\">{riskMetrics.highRiskCount}</p>\n                <p className=\"text-xs text-gray-500 mt-2\">With > 5% movement</p>\n              </div>\n            </div>\n          )}\n\n          {/* Summary Cards */}\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <div className=\"bg-white rounded-lg shadow-md p-4\">\n              <p className=\"text-sm text-gray-600 mb-1\">Total Capital</p>\n              <p className=\"text-3xl font-bold text-gray-900\">\n                ‚Çπ{selectedPortfolio.total_capital?.toLocaleString()}\n              </p>\n            </div>\n            <div className=\"bg-white rounded-lg shadow-md p-4\">\n              <p className=\"text-sm text-gray-600 mb-1\">Invested Amount</p>\n              <p className=\"text-3xl font-bold text-blue-600\">\n                ‚Çπ{selectedPortfolio.invested_amount?.toLocaleString()}\n              </p>\n            </div>\n            <div className=\"bg-white rounded-lg shadow-md p-4\">\n              <p className=\"text-sm text-gray-600 mb-1\">Cash Available</p>\n              <p className=\"text-3xl font-bold text-green-600\">\n                ‚Çπ{(selectedPortfolio.total_capital - selectedPortfolio.invested_amount)?.toLocaleString()}\n              </p>\n            </div>\n            <div className=\"bg-white rounded-lg shadow-md p-4\">\n              <p className=\"text-sm text-gray-600 mb-1\">Total Returns</p>\n              <p className={`text-3xl font-bold ${selectedPortfolio.total_returns >= 0 ? \"text-green-600\" : \"text-red-600\"}`}>\n                {selectedPortfolio.total_returns >= 0 ? \"+\" : \"\"}\n                {selectedPortfolio.total_returns?.toFixed(2)}%\n              </p>\n            </div>\n          </div>\n\n          {/* Add Capital Form */}\n          <div className=\"bg-white rounded-lg shadow-md p-6\">\n            <h3 className=\"text-lg font-bold text-gray-900 mb-4\">Add Capital</h3>\n            <form onSubmit={handleAddCapital} className=\"flex gap-4\">\n              <input\n                type=\"number\"\n                value={addCapitalAmount}\n                onChange={(e) => setAddCapitalAmount(e.target.value)}\n                placeholder=\"Amount to add (‚Çπ)\"\n                className=\"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary\"\n                required\n              />\n              <button\n                type=\"submit\"\n                className=\"bg-green-600 text-white font-semibold py-2 px-6 rounded-lg hover:shadow-lg transition\"\n              >\n                Add Funds\n              </button>\n            </form>\n          </div>\n\n          {/* Positions */}\n          <div className=\"bg-white rounded-lg shadow-md p-6\">\n            <h3 className=\"text-lg font-bold text-gray-900 mb-4\">Open Positions</h3>\n            {selectedPortfolio.positions && selectedPortfolio.positions.length > 0 ? (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-gray-50\">\n                    <tr>\n                      <th className=\"px-4 py-2 text-left text-sm font-semibold text-gray-700\">Symbol</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-semibold text-gray-700\">Quantity</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-semibold text-gray-700\">Entry Price</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-semibold text-gray-700\">Current Price</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-semibold text-gray-700\">P&L</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-semibold text-gray-700\">P&L %</th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"divide-y\">\n                    {selectedPortfolio.positions.map((position) => {\n                      const pnl = position.current_price - position.entry_price;\n                      const pnlPercent = (pnl / position.entry_price) * 100;\n                      return (\n                        <tr key={position.id} className=\"hover:bg-gray-50\">\n                          <td className=\"px-4 py-3 font-semibold text-gray-900\">{position.stock_symbol}</td>\n                          <td className=\"px-4 py-3 text-gray-700\">{position.quantity}</td>\n                          <td className=\"px-4 py-3 text-gray-700\">‚Çπ{position.entry_price}</td>\n                          <td className=\"px-4 py-3 text-gray-700\">‚Çπ{position.current_price}</td>\n                          <td className={`px-4 py-3 font-semibold ${pnl >= 0 ? \"text-green-600\" : \"text-red-600\"}`}>\n                            {pnl >= 0 ? \"+\" : \"\"}‚Çπ{pnl.toFixed(2)}\n                          </td>\n                          <td className={`px-4 py-3 font-semibold ${pnlPercent >= 0 ? \"text-green-600\" : \"text-red-600\"}`}>\n                            {pnlPercent >= 0 ? \"+\" : \"\"}{pnlPercent.toFixed(2)}%\n                          </td>\n                        </tr>\n                      );\n                    })}\n                  </tbody>\n                </table>\n              </div>\n            ) : (\n              <p className=\"text-gray-500\">No open positions</p>\n            )}\n          </div>\n\n          {/* Performance Chart */}\n          <div className=\"bg-white rounded-lg shadow-md p-6\">\n            <h3 className=\"text-lg font-bold text-gray-900 mb-4\">Portfolio Performance</h3>\n            {selectedPortfolio.performance_history && selectedPortfolio.performance_history.length > 0 ? (\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <LineChart data={selectedPortfolio.performance_history}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"date\" />\n                  <YAxis />\n                  <Tooltip formatter={(value) => `‚Çπ${value.toLocaleString()}`} />\n                  <Legend />\n                  <Line\n                    type=\"monotone\"\n                    dataKey=\"value\"\n                    stroke=\"#0088FE\"\n                    dot={false}\n                    name=\"Portfolio Value\"\n                  />\n                </LineChart>\n              </ResponsiveContainer>\n            ) : (\n              <p className=\"text-gray-500\">No performance data available yet</p>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Empty State */}\n      {portfolios.length === 0 && !isLoading && (\n        <div className=\"bg-white rounded-lg shadow-md p-12 text-center\">\n          <p className=\"text-gray-600 text-lg\">No portfolios yet</p>\n          <p className=\"text-gray-400\">Create your first portfolio to start tracking investments</p>\n        </div>\n      )}\n\n      {/* Loading State */}\n      {isLoading && (\n        <div className=\"text-center py-12\">\n          <div className=\"inline-block animate-spin text-4xl\">üíº</div>\n          <p className=\"text-gray-600 mt-4\">Loading portfolios...</p>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}